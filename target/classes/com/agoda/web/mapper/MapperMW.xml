<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.agoda.web.mapper.MapperMW">
	<select id="departureCount" resultType="int" parameterType="com.agoda.web.common.Command">
		SELECT COUNT(*) 
	    FROM 
	    	${table}
	    WHERE 
		 	(from_location like #{data1} 
			and to_location like #{data2} and departure_time like #{data3})
	</select>
	<select id="arrivalCount" resultType="int" parameterType="com.agoda.web.common.Command">
		SELECT COUNT(*) 
	    FROM 
	    	${table}
	    WHERE 
		 	(from_location like #{data2} 
			and to_location like #{data1} and departure_time like #{data4})
	</select>
	<select id="selectFlightList" resultType="com.agoda.web.minwoo.FlightSchedule" parameterType="com.agoda.web.common.Command">
<!-- 		SELECT A2.* FROM(
					SELECT @ROWNUM:=@ROWNUM+1 AS Row, A.*
					FROM(select * from
		 (select 
				 flight_schedule_seq AS flightScheduleSeq,
				 from_location AS fromLocation, 
				 to_location AS toLocation,
				 departure_time AS departureTime,
				 arrival_time AS arrivalTime,
				 price, code, iatacode 
		 from flight_schedule
		 where (from_location like 'seoul' and to_location like 'osaka' and departure_time like '%2018-05-04%')) A1,
		 (select 
		 		flight_schedule_seq AS arvFlightScheduleSeq,
				 from_location AS arvFromLocation, 
				 to_location AS arvToLocation,
				 departure_time AS arvDepartureTime,
				 arrival_time AS arvArrivalTime,
				 price AS arvPrice,
				  code AS arvCode,
				  iatacode AS arviatacode
		 from flight_schedule
		 where (from_location like 'osaka' and to_location like 'seoul' and departure_time like '%2018-05-10%')) A2) A
		 , (SELECT @ROWNUM := 0) R) A2
				WHERE Row BETWEEN '1' and '16'; -->
				
	SELECT
		 flight_schedule_seq AS flightScheduleSeq,
		 from_location AS fromLocation, 
		 to_location AS toLocation,
		 departure_time AS departureTime,
		 arrival_time AS arrivalTime,
		 price, code, iatacode 
	 FROM ${table}
	 WHERE 
	 	(from_location like #{data1} 
		and to_location like #{data2} and departure_time like #{data3})
	 OR
		(from_location like #{data2} 
		and to_location like #{data1} and departure_time like #{data4})
	</select>
	<select id="selectBackFlightList" resultType="com.agoda.web.minwoo.FlightSchedule" parameterType="com.agoda.web.common.Command">
		(SELECT
		 flight_schedule_seq AS flightScheduleSeq,
		 from_location AS fromLocation, 
		 to_location AS toLocation,
		 departure_time AS departureTime,
		 arrival_time AS arrivalTime,
		 price, code, iatacode 
		 FROM ${table} where from_location like #{data2} 
		and to_location like #{data1} and departure_time like #{data4})
	</select>
</mapper>
<!-- SELECT * FROM flightschedule WHERE fromLocation like #{data1} and toLocation like #{data2} and departureTime like #{data3} -->